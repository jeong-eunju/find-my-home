<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Leaflet Zoom 필터링</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    #map { height: 600px; }
  </style>
</head>
<body>
<h3>Zoom할 때마다 해당 지역만 표시!</h3>
<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
<script>
  // 샘플 데이터 (위도, 경도, 주소)
  const data = [
    {lat: 42.03, lon: -93.62, addr: "123 A St"},
    {lat: 42.04, lon: -93.60, addr: "456 B St"},
    {lat: 42.02, lon: -93.63, addr: "789 C St"},
    {lat: 42.05, lon: -93.61, addr: "101 D St"},
    {lat: 42.01, lon: -93.64, addr: "202 E St"}
  ];

  const map = L.map('map').setView([42.03, -93.62], 12);
  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 18,
    attribution: '© OpenStreetMap'
  }).addTo(map);

  let markers = [];

  function plotPoints(bounds) {
    markers.forEach(m => map.removeLayer(m)); // 이전 마커 제거
    markers = [];
    data.forEach(point => {
      if (bounds.contains([point.lat, point.lon])) {
        const marker = L.marker([point.lat, point.lon])
          .addTo(map)
          .bindPopup(point.addr);
        markers.push(marker);
      }
    });
  }

  // 최초 실행
  plotPoints(map.getBounds());

  // zoom / pan 시 다시 필터링
  map.on('moveend', function() {
    plotPoints(map.getBounds());
  });
</script>
</body>
</html>
